<!DOCTYPE html>
<html>
<head>
    <title>Lesson Booking App</title>
    
    <!-- Vue.js -->
    <script src="https://cdn.jsdelivr.net/npm/vue@2.7.16/dist/vue.js"></script>

    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" rel="stylesheet">

    <style>
        button:disabled {
            background-color: gray;
            cursor: not-allowed;
        }
        .lesson-box, .cart-item {
            border: 1px solid black;
            margin: 10px;
            padding: 10px;
        }
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
        }
    </style>
</head>
<body>
<div id="app">
    <header>
        <h1>{{ sitename }}</h1>
        <button v-on:click="toggleCart" :disabled="cart.length === 0">
            {{ cartItemCount }}
            <i class="fa-solid fa-cart-plus"></i> Cart
        </button>
    </header>

    <main>
        <div v-if="showLessons">
            <h2>Available Lessons</h2>

            <label>Sort by:</label>
            <select v-model="sortAttribute">
                <option value="subject">Subject</option>
                <option value="location">Location</option>
                <option value="price">Price</option>
                <option value="spaces">Spaces</option>
            </select>

            <button v-on:click="sortOrder = (sortOrder === 'asc' ? 'desc' : 'asc')">
                {{ sortOrder === 'asc' ? 'Ascending' : 'Descending' }}
            </button>

            <div v-for="lesson in sortedLessons" :key="lesson.id" class="lesson-box">
                <h3><i :class="lesson.icon"></i> {{ lesson.subject }}</h3>
                <p>Location: {{ lesson.location }}</p>
                <p>Price: ${{ lesson.price }}</p>
                <p>Spaces left: {{ lesson.spaces - cartCount(lesson.id) }}</p>

                <button v-on:click="addToCart(lesson)" v-if="canAddToCart(lesson)">Add to Cart</button>

                <span v-if="lesson.spaces === cartCount(lesson.id)">All out!</span>
                <span v-else-if="lesson.spaces - cartCount(lesson.id) < 5">
                    Only {{ lesson.spaces - cartCount(lesson.id) }} left!
                </span>
                <span v-else>Buy now!</span>
            </div>
        </div>

        <!-- Cart Page -->
        <div v-else>
            <h2>Your Cart</h2>
            <div v-for="(lesson, index) in cart" :key="index" class="cart-item">
                <h3>{{ lesson.subject }}</h3>
                <p>Location: {{ lesson.location }}</p>
                <p>Price: ${{ lesson.price }}</p>
                <button v-on:click="removeFromCart(index)">Remove</button>
            </div>
        </div>
    </main>
</div>

<script>
new Vue({
    el: '#app',
    data: {
        sitename: 'Lesson Booking App',
        showLessons: true,
        sortAttribute: 'subject',
        sortOrder: 'asc',
        lessons: [
            { id: 1, subject: "Math", location: "Dubai", price: 100, spaces: 5, icon: "fa-solid fa-calculator" },
            { id: 2, subject: "Science", location: "Sharjah", price: 120, spaces: 5, icon: "fa-solid fa-flask" },
            { id: 3, subject: "English", location: "Abu Dhabi", price: 90, spaces: 5, icon: "fa-solid fa-book" },
            { id: 4, subject: "History", location: "Dubai", price: 110, spaces: 5, icon: "fa-solid fa-landmark" },
            { id: 5, subject: "Geography", location: "Ajman", price: 95, spaces: 5, icon: "fa-solid fa-globe" },
            { id: 6, subject: "Physics", location: "Sharjah", price: 140, spaces: 5, icon: "fa-solid fa-atom" },
            { id: 7, subject: "Chemistry", location: "Ajman", price: 125, spaces: 5, icon: "fa-solid fa-vial" },
            { id: 8, subject: "Biology", location: "Dubai", price: 115, spaces: 5, icon: "fa-solid fa-dna" },
            { id: 9, subject: "Music", location: "Abu Dhabi", price: 80, spaces: 5, icon: "fa-solid fa-music" },
            { id: 10, subject: "Art", location: "Dubai", price: 130, spaces: 5, icon: "fa-solid fa-palette" }
        ],
        cart: []
    },
    methods: {
        toggleCart() {
            this.showLessons = !this.showLessons;
        },
        addToCart(lesson) {
            this.cart.push(lesson);
        },
        removeFromCart(index) {
            this.cart.splice(index, 1);
        },
        canAddToCart(lesson) {
            return lesson.spaces > this.cartCount(lesson.id);
        },
        cartCount(id) {
            return this.cart.filter(item => item.id === id).length;
        }
    },
    computed: {
        cartItemCount() {
            return this.cart.length || "";
        },
        sortedLessons() {
            return this.lessons.slice().sort((a, b) => {
                let modifier = this.sortOrder === 'asc' ? 1 : -1;
                if (a[this.sortAttribute] < b[this.sortAttribute]) return -1 * modifier;
                if (a[this.sortAttribute] > b[this.sortAttribute]) return 1 * modifier;
                return 0;
            });
        }
    }
});
</script>

</body>
</html>